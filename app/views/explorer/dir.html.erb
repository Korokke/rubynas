<% content_for :title, "rubynas :: #{params[:name]}" %>

<% content_for :panel do %>
  <%= render partial: "users/panel_profile" %>
  <%= render partial: "panel_actions" %>
<% end %>

<% content_for :explorer do %>
  <!-- Folder Hierarchy -->
  <nav>
    <% paths = @dirpath.split('/') %>
    <% escaped_paths = paths.map{ |t| ERB::Util.url_encode t } %>
    <% for i in 1..(paths.length - 2) %>
      <span><%= link_to(paths[i], "/" + escaped_paths[1..i].join('/')) %></span> /
    <% end %>
    <span><%= paths.last %></span> /
  </nav>
  <!-- File List Table -->
  <table class="file-list-table" rules="all">
    <!-- Table Header -->
    <tr>
      <th>Name.Extension</th>
      <th width="100px">Size</th>
      <th width="140px">Last Update</th>
    </tr>
    <% Dir.glob("#{@dirpath.gsub(/[\\\{\}\[\]\*\?]/) { |x| "\\" + x }}/*", File::FNM_DOTMATCH)[2..-1].each do |obj| %>
      <tr>
        <td>
          <input type="checkbox" />
          <%= link_to File.basename(obj), "/#{params[:name]}/#{obj.split('/')[2..-1].map{ |t| ERB::Util.url_encode t }.join('/')}" %>
        </td>
        <td>
          <% if File.directory? obj %>
            folder
          <% else %>
            <%= byte2pretty File.size(obj) %>
          <% end %>
        </td>
        <td><%#= %></td>
      </tr>
    <% end %>
  </table>
<% end %>
